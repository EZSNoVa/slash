import{s as ee,o as ue,n as j,k as ce,r as de,d as se,t as Se,p as oe}from"../chunks/scheduler.EpWGcs72.js";import{S as te,i as re,e as W,a as S,p as J,t as I,b as H,d as R,f as b,g as T,h as N,D as ne,k as p,m as Y,j as D,n as K,z as k,F as Q,o as X,r as x,u as O,v as A,w as P,s as U,c as F,E as ve,x as Ie}from"../chunks/index.vVMILz9O.js";import{e as Z,u as qe,o as Ue}from"../chunks/each.IVg80KZZ.js";import{w as G}from"../chunks/index.QmuqCeFS.js";import{a as le,s as Fe,A as fe}from"../chunks/api_shortcuts.noIhwHbn.js";import{F as z,j as xe,k as Oe,l as me,m as Ae,n as Pe,i as Ve,o as je}from"../chunks/index.5n3f9oEu.js";import{E as B,a as V,R as ae,S as pe}from"../chunks/types.emqlGWVk.js";import{w as L}from"../chunks/websocket.UFKR6r8E.js";function Be(i){let e,t="Your request was rejected";return{c(){e=T("p"),e.textContent=t,this.h()},l(r){e=N(r,"P",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1a8t4x3"&&(e.textContent=t),this.h()},h(){p(e,"class","ml-auto text-white rounded-lg py-1 px-4 w-auto float-right border-white bg-red-500")},m(r,l){S(r,e,l)},p:j,i:j,o:j,d(r){r&&b(e)}}}function Le(i){let e,t=i[4]?"Unfriend":"Friends",r,l,f,s;return{c(){e=T("button"),r=Y(t),this.h()},l(a){e=N(a,"BUTTON",{class:!0});var n=D(e);r=K(n,t),n.forEach(b),this.h()},h(){p(e,"class",l="ml-auto text-white rounded-lg py-1 px-4 w-auto float-right border-white "+(i[4]?"bg-red-500":"bg-blue-500"))},m(a,n){S(a,e,n),k(e,r),f||(s=[Q(e,"click",i[8]),Q(e,"mouseenter",i[9]),Q(e,"mouseleave",i[10])],f=!0)},p(a,n){n&16&&t!==(t=a[4]?"Unfriend":"Friends")&&X(r,t),n&16&&l!==(l="ml-auto text-white rounded-lg py-1 px-4 w-auto float-right border-white "+(a[4]?"bg-red-500":"bg-blue-500"))&&p(e,"class",l)},i:j,o:j,d(a){a&&b(e),f=!1,de(s)}}}function Qe(i){let e,t="Cancel",r,l;return{c(){e=T("button"),e.textContent=t,this.h()},l(f){e=N(f,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-eivj96"&&(e.textContent=t),this.h()},h(){p(e,"class","ml-auto border-white text-white rounded-lg py-1 px-4 w-auto float-right hover:bg-red-500")},m(f,s){S(f,e,s),r||(l=Q(e,"click",i[7]),r=!0)},p:j,i:j,o:j,d(f){f&&b(e),r=!1,l()}}}function Je(i){let e,t,r,l,f,s=i[5]===V.REJECTED&&be();return{c(){e=T("button"),t=Y(`Add

		
		`),s&&s.c(),this.h()},l(a){e=N(a,"BUTTON",{class:!0});var n=D(e);t=K(n,`Add

		
		`),s&&s.l(n),n.forEach(b),this.h()},h(){p(e,"class","ml-auto border-green-600 text-white rounded-lg py-1 px-4 w-auto float-right hover:bg-green-500")},m(a,n){S(a,e,n),k(e,t),s&&s.m(e,null),r=!0,l||(f=Q(e,"click",i[6]),l=!0)},p(a,n){a[5]===V.REJECTED?s?n&32&&R(s,1):(s=be(),s.c(),R(s,1),s.m(e,null)):s&&(J(),I(s,1,1,()=>{s=null}),H())},i(a){r||(R(s),r=!0)},o(a){I(s),r=!1},d(a){a&&b(e),s&&s.d(),l=!1,f()}}}function be(i){let e,t,r;return t=new z({props:{icon:xe,class:"text-yellow-600 text-lg inline"}}),{c(){e=T("p"),x(t.$$.fragment),this.h()},l(l){e=N(l,"P",{title:!0,class:!0});var f=D(e);O(t.$$.fragment,f),f.forEach(b),this.h()},h(){p(e,"title","You previously rejected this user"),p(e,"class","inline")},m(l,f){S(l,e,f),A(t,e,null),r=!0},i(l){r||(R(t.$$.fragment,l),r=!0)},o(l){I(t.$$.fragment,l),r=!1},d(l){l&&b(e),P(t)}}}function He(i){let e,t,r,l;const f=[Je,Qe,Le,Be],s=[];function a(n,u){return n[5]===V.NONE||n[5]===V.REJECTED?0:n[5]===V.REQUESTED?1:n[5]===V.FRIENDS?2:n[5]===V.WAS_REJECTED?3:-1}return~(e=a(i))&&(t=s[e]=f[e](i)),{c(){t&&t.c(),r=W()},l(n){t&&t.l(n),r=W()},m(n,u){~e&&s[e].m(n,u),S(n,r,u),l=!0},p(n,[u]){let _=e;e=a(n),e===_?~e&&s[e].p(n,u):(t&&(J(),I(s[_],1,1,()=>{s[_]=null}),H()),~e?(t=s[e],t?t.p(n,u):(t=s[e]=f[e](n),t.c()),R(t,1),t.m(r.parentNode,r)):t=null)},i(n){l||(R(t),l=!0)},o(n){I(t),l=!1},d(n){n&&b(r),~e&&s[e].d(n)}}}function Me(i,e,t){let r,l=j,f=()=>(l(),l=ce(a,v=>t(5,r=v)),a);i.$$.on_destroy.push(()=>l());let{username:s}=e,{friendship:a}=e;f();let{other_user:n}=e,{remove_friend:u}=e,_=!1;ue(()=>{L.on(B.ACCEPT_FRIEND_REQUEST,v=>{v===n&&a.set(V.FRIENDS)}),L.on(B.REJECT_FRIEND_REQUEST,v=>{v===n&&a.set(V.REJECTED)})});const y=async()=>{a.set(V.REQUESTED),await le(s,n,V.REQUESTED),L.emit(B.NEW_FRIEND_REQUEST,n)},m=async()=>{a.set(V.NONE),await le(s,n,V.NONE),L.emit(B.CANCEL_FRIEND_REQUEST,n)},h=async()=>{a.set(V.NONE),await le(s,n,V.NONE),L.emit(B.UNFRIEND,n),u(n)},c=()=>t(4,_=!0),d=()=>t(4,_=!1);return i.$$set=v=>{"username"in v&&t(0,s=v.username),"friendship"in v&&f(t(1,a=v.friendship)),"other_user"in v&&t(2,n=v.other_user),"remove_friend"in v&&t(3,u=v.remove_friend)},[s,a,n,u,_,r,y,m,h,c,d]}class ze extends te{constructor(e){super(),re(this,e,Me,He,ee,{username:0,friendship:1,other_user:2,remove_friend:3})}}function Ee(i,e,t){const r=i.slice();return r[14]=e[t],r}function we(i){let e,t,r,l,f,s,a,n,u,_,y,m,h,c,d,v,E;l=new z({props:{icon:me}});const g=[Ge,We],o=[];function w($,C){return $[6]?1:0}return h=w(i),c=o[h]=g[h](i),{c(){e=T("div"),t=T("div"),r=T("button"),x(l.$$.fragment),f=U(),s=T("div"),a=T("div"),n=T("input"),_=U(),y=T("div"),m=T("ol"),c.c(),this.h()},l($){e=N($,"DIV",{class:!0});var C=D(e);t=N(C,"DIV",{class:!0});var q=D(t);r=N(q,"BUTTON",{class:!0});var M=D(r);O(l.$$.fragment,M),M.forEach(b),q.forEach(b),f=F(C),s=N(C,"DIV",{class:!0});var ie=D(s);a=N(ie,"DIV",{class:!0});var he=D(a);n=N(he,"INPUT",{type:!0,placeholder:!0,class:!0}),he.forEach(b),_=F(ie),y=N(ie,"DIV",{class:!0});var _e=D(y);m=N(_e,"OL",{});var ge=D(m);c.l(ge),ge.forEach(b),_e.forEach(b),ie.forEach(b),C.forEach(b),this.h()},h(){p(r,"class","border-white text-white rounded-full p-2 hover:bg-slate-600"),p(t,"class","absolute top-3 left-1/2 transform -translate-x-1/2 mt-2"),n.autofocus=!0,p(n,"type","text"),p(n,"placeholder","Search for some user"),p(n,"class",u="w-full p-2 border-white outline-none rounded-md max-h-max "+(i[5]===i[7].searching?"cursor-wait":"")),p(a,"class","mb-5"),p(y,"class","container flex flex-col"),p(s,"class","bg-gray-800 m-auto mt-24 p-5 rounded-md border border-gray-700 w-4/5"),p(e,"class","fixed inset-0 z-10 overflow-auto bg-black bg-opacity-40")},m($,C){S($,e,C),k(e,t),k(t,r),A(l,r,null),k(e,f),k(e,s),k(s,a),k(a,n),ve(n,i[3]),k(s,_),k(s,y),k(y,m),o[h].m(m,null),d=!0,n.focus(),v||(E=[Q(r,"click",i[12]),Q(n,"input",i[13]),Q(n,"input",i[10]),Q(n,"change",i[10])],v=!0)},p($,C){(!d||C&32&&u!==(u="w-full p-2 border-white outline-none rounded-md max-h-max "+($[5]===$[7].searching?"cursor-wait":"")))&&p(n,"class",u),C&8&&n.value!==$[3]&&ve(n,$[3]);let q=h;h=w($),h===q?o[h].p($,C):(J(),I(o[q],1,1,()=>{o[q]=null}),H(),c=o[h],c?c.p($,C):(c=o[h]=g[h]($),c.c()),R(c,1),c.m(m,null))},i($){d||(R(l.$$.fragment,$),R(c),d=!0)},o($){I(l.$$.fragment,$),I(c),d=!1},d($){$&&b(e),P(l),o[h].d(),v=!1,de(E)}}}function We(i){let e=[],t=new Map,r,l,f=Z(i[6]);const s=a=>a[14];for(let a=0;a<f.length;a+=1){let n=Ee(i,f,a),u=s(n);t.set(u,e[a]=ke(u,n))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();r=W()},l(a){for(let n=0;n<e.length;n+=1)e[n].l(a);r=W()},m(a,n){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(a,n);S(a,r,n),l=!0},p(a,n){n&70&&(f=Z(a[6]),J(),e=qe(e,n,s,1,a,f,t,r.parentNode,Ue,ke,r,Ee),H())},i(a){if(!l){for(let n=0;n<f.length;n+=1)R(e[n]);l=!0}},o(a){for(let n=0;n<e.length;n+=1)I(e[n]);l=!1},d(a){a&&b(r);for(let n=0;n<e.length;n+=1)e[n].d(a)}}}function Ge(i){let e,t="Nothing here...";return{c(){e=T("p"),e.textContent=t,this.h()},l(r){e=N(r,"P",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-1h5nyls"&&(e.textContent=t),this.h()},h(){p(e,"class","text-gray-400")},m(r,l){S(r,e,l)},p:j,i:j,o:j,d(r){r&&b(e)}}}function ke(i,e){let t,r,l,f,s,a=e[14].username+"",n,u,_,y,m,h;return l=new fe({props:{username:e[14].username}}),_=new ze({props:{username:e[1].username,friendship:e[14].friendship,other_user:e[14].username,remove_friend:e[2]}}),{key:i,first:null,c(){t=T("button"),r=T("li"),x(l.$$.fragment),f=U(),s=T("p"),n=Y(a),u=U(),x(_.$$.fragment),y=U(),this.h()},l(c){t=N(c,"BUTTON",{title:!0,class:!0});var d=D(t);r=N(d,"LI",{class:!0});var v=D(r);O(l.$$.fragment,v),f=F(v),s=N(v,"P",{class:!0});var E=D(s);n=K(E,a),E.forEach(b),u=F(v),O(_.$$.fragment,v),v.forEach(b),y=F(d),d.forEach(b),this.h()},h(){p(s,"class","ml-2"),p(r,"class","flex items-center justify-center mb-2 p-2 rounded-md w-full "),p(t,"title",m="Search result: "+e[14].username),p(t,"class","w-full border-none hover:bg-gray-700 p-1 flex justify-center items-center"),this.first=t},m(c,d){S(c,t,d),k(t,r),A(l,r,null),k(r,f),k(r,s),k(s,n),k(r,u),A(_,r,null),k(t,y),h=!0},p(c,d){e=c;const v={};d&64&&(v.username=e[14].username),l.$set(v),(!h||d&64)&&a!==(a=e[14].username+"")&&X(n,a);const E={};d&2&&(E.username=e[1].username),d&64&&(E.friendship=e[14].friendship),d&64&&(E.other_user=e[14].username),d&4&&(E.remove_friend=e[2]),_.$set(E),(!h||d&64&&m!==(m="Search result: "+e[14].username))&&p(t,"title",m)},i(c){h||(R(l.$$.fragment,c),R(_.$$.fragment,c),h=!0)},o(c){I(l.$$.fragment,c),I(_.$$.fragment,c),h=!1},d(c){c&&b(t),P(l),P(_)}}}function Ye(i){let e,t,r,l,f,s,a;t=new z({props:{icon:Oe,class:"text-2xl text-#888 mr-2 hover:text-white"}});let n=i[4]&&we(i);return{c(){e=T("button"),x(t.$$.fragment),r=U(),n&&n.c(),l=W(),this.h()},l(u){e=N(u,"BUTTON",{class:!0,title:!0});var _=D(e);O(t.$$.fragment,_),_.forEach(b),r=F(u),n&&n.l(u),l=W(),this.h()},h(){p(e,"class","border-none p-1 mx-1 grow-rotate w-auto svelte-dsylrc"),p(e,"title","Search for users")},m(u,_){S(u,e,_),A(t,e,null),S(u,r,_),n&&n.m(u,_),S(u,l,_),f=!0,s||(a=Q(e,"click",i[11]),s=!0)},p(u,[_]){u[4]?n?(n.p(u,_),_&16&&R(n,1)):(n=we(u),n.c(),R(n,1),n.m(l.parentNode,l)):n&&(J(),I(n,1,1,()=>{n=null}),H())},i(u){f||(R(t.$$.fragment,u),R(n),f=!0)},o(u){I(t.$$.fragment,u),I(n),f=!1},d(u){u&&(b(e),b(r),b(l)),P(t),n&&n.d(u),s=!1,a()}}}function Ke(i,e,t){let r,l=j,f=()=>(l(),l=ce(u,o=>t(4,r=o)),u),s,a;i.$$.on_destroy.push(()=>l());var n=(o=>(o[o.idle=0]="idle",o[o.searching=1]="searching",o))(n||{});let{modal_open:u}=e;f();let{user:_}=e,{remove_friend:y}=e,m="",h=G([]);se(i,h,o=>t(6,a=o));let c=G(0);se(i,c,o=>t(5,s=o));async function d(){c.set(1),h.set(await Fe(m,_)),c.set(0)}ue(()=>{window.addEventListener("keydown",o=>{o.key==="Escape"&&u.set(!1)})});const v=()=>u.set(!0),E=()=>u.set(!1);function g(){m=this.value,t(3,m)}return i.$$set=o=>{"modal_open"in o&&f(t(0,u=o.modal_open)),"user"in o&&t(1,_=o.user),"remove_friend"in o&&t(2,y=o.remove_friend)},[u,_,y,m,r,s,a,n,h,c,d,v,E,g]}class Xe extends te{constructor(e){super(),re(this,e,Ke,Ye,ee,{modal_open:0,user:1,remove_friend:2})}}function Ze(i){let e,t,r,l,f,s,a,n,u,_,y,m,h,c,d,v,E;return r=new fe({props:{username:i[1]}}),_=new z({props:{icon:me,class:"mx-1 text-2xl"}}),h=new z({props:{icon:Ae,class:"text-2xl"}}),{c(){e=T("button"),t=T("li"),x(r.$$.fragment),l=U(),f=T("p"),s=Y(i[1]),a=U(),n=T("div"),u=T("button"),x(_.$$.fragment),y=U(),m=T("button"),x(h.$$.fragment),this.h()},l(g){e=N(g,"BUTTON",{class:!0,title:!0});var o=D(e);t=N(o,"LI",{class:!0});var w=D(t);O(r.$$.fragment,w),l=F(w),f=N(w,"P",{class:!0});var $=D(f);s=K($,i[1]),$.forEach(b),a=F(w),n=N(w,"DIV",{class:!0});var C=D(n);u=N(C,"BUTTON",{class:!0,title:!0});var q=D(u);O(_.$$.fragment,q),q.forEach(b),y=F(C),m=N(C,"BUTTON",{class:!0,title:!0});var M=D(m);O(h.$$.fragment,M),M.forEach(b),C.forEach(b),w.forEach(b),o.forEach(b),this.h()},h(){p(f,"class","ml-2 text-lg"),p(u,"class","w-auto h-full m-0 p-3 rounded-sm hover:bg-red-600 hover:text-white border-none "),p(u,"title","Reject request"),p(m,"class","w-auto h-full m-0 p-3 rounded-sm hover:bg-green-600 hover:text-white border-none "),p(m,"title","Accept request"),p(n,"class","flex items-center justify-end w-full h-full p-0"),p(t,"class","h-full flex items-center rounded-md w-full p-0 py-1 pl-2 hover:bg-gray-700 "),p(e,"class","border-none bg-none w-full m-1"),p(e,"title",c="Friend request from "+i[1])},m(g,o){S(g,e,o),k(e,t),A(r,t,null),k(t,l),k(t,f),k(f,s),k(t,a),k(t,n),k(n,u),A(_,u,null),k(n,y),k(n,m),A(h,m,null),d=!0,v||(E=[Q(u,"click",i[4]),Q(m,"click",i[5])],v=!0)},p(g,[o]){const w={};o&2&&(w.username=g[1]),r.$set(w),(!d||o&2)&&X(s,g[1]),(!d||o&2&&c!==(c="Friend request from "+g[1]))&&p(e,"title",c)},i(g){d||(R(r.$$.fragment,g),R(_.$$.fragment,g),R(h.$$.fragment,g),d=!0)},o(g){I(r.$$.fragment,g),I(_.$$.fragment,g),I(h.$$.fragment,g),d=!1},d(g){g&&b(e),P(r),P(_),P(h),v=!1,de(E)}}}function et(i,e,t){let{username:r}=e,{requester:l}=e,{remove_request:f}=e,{add_friend:s}=e;const a=async()=>{await le(r,l,V.REJECTED),f(l),L.emit(B.REJECT_FRIEND_REQUEST,l)},n=async()=>{await le(r,l,V.FRIENDS),f(l),s(l),L.emit(B.ACCEPT_FRIEND_REQUEST,l)};return i.$$set=u=>{"username"in u&&t(0,r=u.username),"requester"in u&&t(1,l=u.requester),"remove_request"in u&&t(2,f=u.remove_request),"add_friend"in u&&t(3,s=u.add_friend)},[r,l,f,s,a,n]}class tt extends te{constructor(e){super(),re(this,e,et,Ze,ee,{username:0,requester:1,remove_request:2,add_friend:3})}}function $e(i,e,t){const r=i.slice();return r[10]=e[t],r}function rt(i){let e,t,r,l,f;return t=new z({props:{icon:Pe,class:"text-2xl"}}),{c(){e=T("button"),x(t.$$.fragment),this.h()},l(s){e=N(s,"BUTTON",{class:!0,title:!0});var a=D(e);O(t.$$.fragment,a),a.forEach(b),this.h()},h(){p(e,"class","bright border-none p-1 mx-1 grow-rotate w-auto svelte-8ok0sg"),p(e,"title","Pending requests")},m(s,a){S(s,e,a),A(t,e,null),r=!0,l||(f=Q(e,"click",i[9]),l=!0)},p:j,i(s){r||(R(t.$$.fragment,s),r=!0)},o(s){I(t.$$.fragment,s),r=!1},d(s){s&&b(e),P(t),l=!1,f()}}}function nt(i){let e,t,r,l,f,s,a,n="Pending requests",u,_,y,m,h;l=new z({props:{icon:me}});let c=Z(i[2]),d=[];for(let E=0;E<c.length;E+=1)d[E]=Te($e(i,c,E));const v=E=>I(d[E],1,1,()=>{d[E]=null});return{c(){e=T("div"),t=T("div"),r=T("button"),x(l.$$.fragment),f=U(),s=T("div"),a=T("h3"),a.textContent=n,u=U(),_=T("ol");for(let E=0;E<d.length;E+=1)d[E].c();this.h()},l(E){e=N(E,"DIV",{class:!0});var g=D(e);t=N(g,"DIV",{class:!0});var o=D(t);r=N(o,"BUTTON",{class:!0});var w=D(r);O(l.$$.fragment,w),w.forEach(b),o.forEach(b),f=F(g),s=N(g,"DIV",{class:!0});var $=D(s);a=N($,"H3",{class:!0,"data-svelte-h":!0}),ne(a)!=="svelte-1ozeatd"&&(a.textContent=n),u=F($),_=N($,"OL",{class:!0});var C=D(_);for(let q=0;q<d.length;q+=1)d[q].l(C);C.forEach(b),$.forEach(b),g.forEach(b),this.h()},h(){p(r,"class","border-white text-white rounded-full p-2 hover:bg-slate-600"),p(t,"class","absolute top-3 left-1/2 transform -translate-x-1/2 mt-2"),p(a,"class","text-xl text-gray-100 mb-2"),p(_,"class","w-full"),p(s,"class","flex flex-col items-center bg-gray-800 m-auto mt-24 p-2 rounded-md border border-gray-700 w-4/5 max-w-screen-xl"),p(e,"class","fixed inset-0 z-10 overflow-auto bg-black bg-opacity-40")},m(E,g){S(E,e,g),k(e,t),k(t,r),A(l,r,null),k(e,f),k(e,s),k(s,a),k(s,u),k(s,_);for(let o=0;o<d.length;o+=1)d[o]&&d[o].m(_,null);y=!0,m||(h=Q(r,"click",i[8]),m=!0)},p(E,g){if(g&102){c=Z(E[2]);let o;for(o=0;o<c.length;o+=1){const w=$e(E,c,o);d[o]?(d[o].p(w,g),R(d[o],1)):(d[o]=Te(w),d[o].c(),R(d[o],1),d[o].m(_,null))}for(J(),o=c.length;o<d.length;o+=1)v(o);H()}},i(E){if(!y){R(l.$$.fragment,E);for(let g=0;g<c.length;g+=1)R(d[g]);y=!0}},o(E){I(l.$$.fragment,E),d=d.filter(Boolean);for(let g=0;g<d.length;g+=1)I(d[g]);y=!1},d(E){E&&b(e),P(l),Ie(d,E),m=!1,h()}}}function Te(i){let e,t;return e=new tt({props:{username:i[1],requester:i[10],remove_request:i[5],add_friend:i[6]}}),{c(){x(e.$$.fragment)},l(r){O(e.$$.fragment,r)},m(r,l){A(e,r,l),t=!0},p(r,l){const f={};l&2&&(f.username=r[1]),l&4&&(f.requester=r[10]),e.$set(f)},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){I(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function lt(i){let e,t,r,l;const f=[nt,rt],s=[];function a(n,u){return n[3]?0:1}return e=a(i),t=s[e]=f[e](i),{c(){t.c(),r=W()},l(n){t.l(n),r=W()},m(n,u){s[e].m(n,u),S(n,r,u),l=!0},p(n,[u]){let _=e;e=a(n),e===_?s[e].p(n,u):(J(),I(s[_],1,1,()=>{s[_]=null}),H(),t=s[e],t?t.p(n,u):(t=s[e]=f[e](n),t.c()),R(t,1),t.m(r.parentNode,r))},i(n){l||(R(t),l=!0)},o(n){I(t),l=!1},d(n){n&&b(r),s[e].d(n)}}}function st(i,e,t){let r,l=j,f=()=>(l(),l=ce(a,d=>t(2,r=d)),a),s;i.$$.on_destroy.push(()=>l());let{requests:a}=e;f();let{friends:n}=e,{username:u}=e,_=G(!1);se(i,_,d=>t(3,s=d)),ue(()=>{window.addEventListener("keydown",d=>{d.key==="Escape"&&_.set(!1)})});const y=d=>{a.update(()=>r.filter(v=>v!=d))},m=d=>{n.update(v=>[d,...v])},h=()=>_.set(!1),c=()=>_.set(!0);return i.$$set=d=>{"requests"in d&&f(t(0,a=d.requests)),"friends"in d&&t(7,n=d.friends),"username"in d&&t(1,u=d.username)},[a,u,r,s,_,y,m,n,h,c]}class at extends te{constructor(e){super(),re(this,e,st,lt,ee,{requests:0,friends:7,username:1})}}function Ne(i){let e,t;return e=new z({props:{icon:Ve,class:"inline text-purple-500 text-sm"}}),{c(){x(e.$$.fragment)},l(r){O(e.$$.fragment,r)},m(r,l){A(e,r,l),t=!0},i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){I(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function it(i){let e,t,r,l,f,s,a,n,u,_,y,m;f=new fe({props:{username:i[0]}});let h=i[1]&&Ne();return{c(){e=T("div"),t=T("div"),r=T("div"),l=T("a"),x(f.$$.fragment),a=U(),n=T("p"),u=Y(i[0]),_=U(),y=T("span"),h&&h.c(),this.h()},l(c){e=N(c,"DIV",{class:!0});var d=D(e);t=N(d,"DIV",{class:!0});var v=D(t);r=N(v,"DIV",{class:!0});var E=D(r);l=N(E,"A",{href:!0,class:!0,title:!0});var g=D(l);O(f.$$.fragment,g),g.forEach(b),a=F(E),n=N(E,"P",{class:!0});var o=D(n);u=K(o,i[0]),_=F(o),y=N(o,"SPAN",{title:!0});var w=D(y);h&&h.l(w),w.forEach(b),o.forEach(b),E.forEach(b),v.forEach(b),d.forEach(b),this.h()},h(){p(l,"href",s=ae.PROFILE+"/"+i[0]),p(l,"class","rotate text-gray-400 hover:text-gray-100"),p(l,"title","Profile"),p(y,"title","Verified"),p(n,"class","inline text-gray-30 font-normal text-lg mr-4"),p(r,"class","flex justify-between items-center"),p(t,"class","contanier w-8/12 p-2 rounded-lg bg-gray-800"),p(e,"class","bottom-bar flex p-2 items-center justify-center svelte-5hu0jj")},m(c,d){S(c,e,d),k(e,t),k(t,r),k(r,l),A(f,l,null),k(r,a),k(r,n),k(n,u),k(n,_),k(n,y),h&&h.m(y,null),m=!0},p(c,[d]){const v={};d&1&&(v.username=c[0]),f.$set(v),(!m||d&1&&s!==(s=ae.PROFILE+"/"+c[0]))&&p(l,"href",s),(!m||d&1)&&X(u,c[0]),c[1]?h?d&2&&R(h,1):(h=Ne(),h.c(),R(h,1),h.m(y,null)):h&&(J(),I(h,1,1,()=>{h=null}),H())},i(c){m||(R(f.$$.fragment,c),R(h),m=!0)},o(c){I(f.$$.fragment,c),I(h),m=!1},d(c){c&&b(e),P(f),h&&h.d()}}}function ot(i,e,t){let{username:r}=e,{verified:l}=e;return i.$$set=f=>{"username"in f&&t(0,r=f.username),"verified"in f&&t(1,l=f.verified)},[r,l]}class ut extends te{constructor(e){super(),re(this,e,ot,it,ee,{username:0,verified:1})}}function ye(i,e,t){const r=i.slice();return r[9]=e[t],r}function Re(i){let e,t;return e=new at({props:{username:i[4].username,requests:i[5],friends:i[7]}}),{c(){x(e.$$.fragment)},l(r){O(e.$$.fragment,r)},m(r,l){A(e,r,l),t=!0},p:j,i(r){t||(R(e.$$.fragment,r),t=!0)},o(r){I(e.$$.fragment,r),t=!1},d(r){P(e,r)}}}function Ce(i){let e,t,r,l,f,s=i[9]+"",a,n,u,_="-",y,m,h=oe(i[1][i[9]])+"",c,d,v,E;return r=new fe({props:{username:i[9]}}),{c(){e=T("a"),t=T("div"),x(r.$$.fragment),l=U(),f=T("h4"),a=Y(s),n=U(),u=T("span"),u.textContent=_,y=U(),m=T("p"),c=Y(h),this.h()},l(g){e=N(g,"A",{class:!0,href:!0});var o=D(e);t=N(o,"DIV",{class:!0});var w=D(t);O(r.$$.fragment,w),l=F(w),f=N(w,"H4",{class:!0});var $=D(f);a=K($,s),$.forEach(b),n=F(w),u=N(w,"SPAN",{class:!0,"data-svelte-h":!0}),ne(u)!=="svelte-1fp6drv"&&(u.textContent=_),y=F(w),m=N(w,"P",{class:!0});var C=D(m);c=K(C,h),C.forEach(b),w.forEach(b),o.forEach(b),this.h()},h(){p(f,"class","ml-4 font-normal text-lg text-gray-200"),p(u,"class","mx-2 text-gray-500"),p(m,"class",d=oe(i[1][i[9]])+" text-gray-400 text-sm svelte-33kfmv"),p(t,"class","flex items-center justify-start rounded-md p-2 transition-colors hover:bg-gray-700 cursor-pointer w-full "),p(e,"class","w-full p-1"),p(e,"href",v=ae.CHAT_REDIRECT+"/"+i[9])},m(g,o){S(g,e,o),k(e,t),A(r,t,null),k(t,l),k(t,f),k(f,a),k(t,n),k(t,u),k(t,y),k(t,m),k(m,c),E=!0},p(g,o){const w={};o&4&&(w.username=g[9]),r.$set(w),(!E||o&4)&&s!==(s=g[9]+"")&&X(a,s),(!E||o&6)&&h!==(h=oe(g[1][g[9]])+"")&&X(c,h),(!E||o&6&&d!==(d=oe(g[1][g[9]])+" text-gray-400 text-sm svelte-33kfmv"))&&p(m,"class",d),(!E||o&4&&v!==(v=ae.CHAT_REDIRECT+"/"+g[9]))&&p(e,"href",v)},i(g){E||(R(r.$$.fragment,g),E=!0)},o(g){I(r.$$.fragment,g),E=!1},d(g){g&&b(e),P(r)}}}function De(i){let e,t='<h4 class="text-xl">No friends yet</h4> <p class="text-md">Search for people to add them as friends</p>';return{c(){e=T("div"),e.innerHTML=t,this.h()},l(r){e=N(r,"DIV",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-t0dwgu"&&(e.innerHTML=t),this.h()},h(){p(e,"class","text-gray-400 text-center w-full")},m(r,l){S(r,e,l)},d(r){r&&b(e)}}}function ft(i){let e,t,r,l,f,s,a,n,u,_,y,m,h,c=i[3].length>0&&Re(i);l=new Xe({props:{modal_open:i[6],user:i[4],remove_friend:i[8]}}),a=new z({props:{icon:je,class:"text-2xl"}});let d=Z(i[2]),v=[];for(let o=0;o<d.length;o+=1)v[o]=Ce(ye(i,d,o));const E=o=>I(v[o],1,1,()=>{v[o]=null});let g=i[2].length===0&&De();return m=new ut({props:{username:i[0].user.username,verified:i[0].user.verified}}),{c(){e=T("div"),t=T("nav"),c&&c.c(),r=U(),x(l.$$.fragment),f=U(),s=T("a"),x(a.$$.fragment),n=U(),u=T("div");for(let o=0;o<v.length;o+=1)v[o].c();_=U(),g&&g.c(),y=U(),x(m.$$.fragment),this.h()},l(o){e=N(o,"DIV",{class:!0});var w=D(e);t=N(w,"NAV",{class:!0});var $=D(t);c&&c.l($),r=F($),O(l.$$.fragment,$),f=F($),s=N($,"A",{href:!0,class:!0,title:!0});var C=D(s);O(a.$$.fragment,C),C.forEach(b),$.forEach(b),n=F(w),u=N(w,"DIV",{class:!0});var q=D(u);for(let M=0;M<v.length;M+=1)v[M].l(q);_=F(q),g&&g.l(q),q.forEach(b),w.forEach(b),y=F(o),O(m.$$.fragment,o),this.h()},h(){p(s,"href",ae.SETTINGS),p(s,"class","rotate text-gray-400 hover:text-gray-100 svelte-33kfmv"),p(s,"title","Settings"),p(t,"class","mt-2 flex justify-between items-center w-full p-2 border-b border-gray-700"),p(u,"class","rounded-sm w-full mt-4 flex flex-col justify-center items-start p-2 overflow-y-hidden overflow-x-auto "),p(e,"class","container")},m(o,w){S(o,e,w),k(e,t),c&&c.m(t,null),k(t,r),A(l,t,null),k(t,f),k(t,s),A(a,s,null),k(e,n),k(e,u);for(let $=0;$<v.length;$+=1)v[$]&&v[$].m(u,null);k(u,_),g&&g.m(u,null),S(o,y,w),A(m,o,w),h=!0},p(o,[w]){if(o[3].length>0?c?(c.p(o,w),w&8&&R(c,1)):(c=Re(o),c.c(),R(c,1),c.m(t,r)):c&&(J(),I(c,1,1,()=>{c=null}),H()),w&6){d=Z(o[2]);let C;for(C=0;C<d.length;C+=1){const q=ye(o,d,C);v[C]?(v[C].p(q,w),R(v[C],1)):(v[C]=Ce(q),v[C].c(),R(v[C],1),v[C].m(u,_))}for(J(),C=d.length;C<v.length;C+=1)E(C);H()}o[2].length===0?g||(g=De(),g.c(),g.m(u,null)):g&&(g.d(1),g=null);const $={};w&1&&($.username=o[0].user.username),w&1&&($.verified=o[0].user.verified),m.$set($)},i(o){if(!h){R(c),R(l.$$.fragment,o),R(a.$$.fragment,o);for(let w=0;w<d.length;w+=1)R(v[w]);R(m.$$.fragment,o),h=!0}},o(o){I(c),I(l.$$.fragment,o),I(a.$$.fragment,o),v=v.filter(Boolean);for(let w=0;w<v.length;w+=1)I(v[w]);I(m.$$.fragment,o),h=!1},d(o){o&&(b(e),b(y)),c&&c.d(),P(l),P(a),Ie(v,o),g&&g.d(),P(m,o)}}}function ct(i,e,t){let r,l,{data:f}=e,s=f.user,a=G(s.pending_requests);se(i,a,m=>t(3,l=m));let n=G(!1),u=G(s.friends);se(i,u,m=>t(2,r=m));let _={};for(let m of s.friends)_[m]=G(pe.OFFLINE);ue(async()=>{await Se(),window.onkeydown=m=>{m.key==="p"&&(n.set(!0),m.preventDefault())},L.on(B.NEW_FRIEND_REQUEST,m=>{m&&a.update(h=>[m,...h])}),L.on(B.CANCEL_FRIEND_REQUEST,m=>{m&&a.update(h=>h.filter(c=>c!==m))}),L.on(B.ACCEPT_FRIEND_REQUEST,m=>{u.update(h=>[m,...h])}),L.on(B.UNFRIEND,m=>{u.update(h=>h.filter(c=>c!==m))}),L.on(B.STATUS,(m,h)=>{m in _&&_[m].set(h)}),L.emit(B.CONNECT,s.username),L.emit(B.SET_STATUS,pe.ONLINE,r),L.emit(B.GET_FRIENDS_STATUS,r)});const y=m=>{u.update(h=>h.filter(c=>c!==m))};return i.$$set=m=>{"data"in m&&t(0,f=m.data)},[f,_,r,l,s,a,n,u,y]}class Et extends te{constructor(e){super(),re(this,e,ct,ft,ee,{data:0})}}export{Et as component};
