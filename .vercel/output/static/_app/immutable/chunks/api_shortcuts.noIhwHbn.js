import{s as p,j as u,n as l,d as _,o as g}from"./scheduler.EpWGcs72.js";import{S as y,i as b,g as S,h as w,k as o,a as j,f as O}from"./index.vVMILz9O.js";import{w as m}from"./index.QmuqCeFS.js";const h=m({});function T(t){let e,s,r;return{c(){e=S("img"),this.h()},l(a){e=w(a,"IMG",{src:!0,alt:!0,class:!0,loading:!0}),this.h()},h(){u(e.src,s=t[1])||o(e,"src",s),o(e,"alt",r=t[0]+"'s Slash Avatar"),o(e,"class","max-w-[2.5em] max-h-[2.5em] rounded-full"),o(e,"loading","lazy")},m(a,n){j(a,e,n)},p(a,[n]){n&2&&!u(e.src,s=a[1])&&o(e,"src",s),n&1&&r!==(r=a[0]+"'s Slash Avatar")&&o(e,"alt",r)},i:l,o:l,d(a){a&&O(e)}}}function v(t,e,s){let r;_(t,h,i=>s(3,r=i));let{username:a}=e,{use_cache:n=!0}=e,c=`/avatar/${a}`;return g(async()=>{if(n)if(r[a])s(1,c=r[a]);else{let i=await fetch(`/avatar/${a}`);if(i.ok){const f=await i.blob();s(1,c=URL.createObjectURL(f)),h.update(d=>({...d,[a]:c}))}}}),t.$$set=i=>{"username"in i&&s(0,a=i.username),"use_cache"in i&&s(2,n=i.use_cache)},[a,c,n]}class k extends y{constructor(e){super(),b(this,e,v,T,p,{username:0,use_cache:2})}}async function J(t,e){return(await(await fetch("/api/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t,user:e})})).json()).map(n=>({...n,friendship:m(n.friendship)}))}async function N(t,e,s){return(await fetch("/api/update_friendship",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:t,other:e,status:s})})).status===200}async function q(t){return(await fetch("/api/message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).status===200}async function x(t){let e=await fetch("/api/file/upload",{method:"POST",body:t});return e.ok?e.json():(console.log("Error uploading attachments",e),[])}export{k as A,N as a,h as c,q as h,J as s,x as u};
